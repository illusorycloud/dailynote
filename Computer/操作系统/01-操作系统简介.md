# 操作系统简介

## 1. 操作系统做了什么

### 1.1 执行`helloworld`程序

```c
#include<studio.h>
int main(int argc,char *argv[])
{
    puts("hello world");
    return 0;
}
```

执行步骤

* 1.**用户**:告诉操作系统执行`helloworld`程序(命令行、双击可执行文件等)
* 2.**操作系统**：根据文件名在磁盘上查找`helloworld`程序的相关信息，检查是否为`可执行文件`(windows:`PE`,Linux:`ELF`)。并通过程序首部信息确定`代码``和数据`在可执行文件中的位置并计算出对应的`磁盘块地址`。
* 3.**操作系统**：创建一个新的`进程`，并将`Helloworld`程序可执行文件映射到该进程结构，表示由该进程执行`helloworld`程序
* 4.**操作系统**:为`helloworld`程序设置CPU`上下文环境`，并调到程序开始处。
* 5.执行`helloworld`程序的第一条指令，发生**缺页异常**(程序执行前需要先把代码和数据读入内存,cpu才能执行,这时候`helloworld`程序还未读入内存)。
* 6.**操作系统**:分配一页物理内存，并将代码从磁盘读入内存，然后继续执行`helloworld`程序
* 7.**helloworld程序**:执行**puts**函数(系统调用)，在显示器上写一字符串
* 8.**操作系统**：找到要显示的显示设备，通常设备是由一进程控制的，所以操作系统将要写的字符串送给该进程。
* 9.**操作系统**：控制设备的进程告诉设备的窗口系统它要显示字符串，窗口系统确定这是一个合法的操作，然后将字符串转换成像素，将像素写入设备的存储映像区。
* 10.**视频硬件**：将像素转换成显示器可以接收的一组控制/数据信号
* 11.**显示器**：解释信号，激发液晶屏
* 12.**结果**：在屏幕上看到了`hello world`

### 1.2 小结

程序执行中，操作系统负责了程序的启动过程，执行过程，同时在执行过程中不断的为用户程序执行提供各种支持。
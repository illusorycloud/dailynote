# MySQL数据目录



## 1. 数据目录位置

Unix系统里，如果通过二进制或源代码发行版安装MySQL，那么数据目录通常默认为`/usr/local/mysql/data`

如果通过RPM包安装则默认为`/var/lib/mysql`

源码编译时可以在运行CMake时使用命令行选项`--DMYSQL_DATADIR=dir_name`来指定默认目录

也可以在启动时使用`--datadir=dir_name`选项。



也可以通过命令`SHOW VARIABLES`查看运行中的MySQL服务器相关信息。



## 数据目录结构



### 1.表在文件系统里的表示

InnoDB是默认存储引擎，在数据库目录里每个InnoDB表都有一个`.frm`文件,其中包含了**表结构的定义**。

对于**表的内容**，InnoDB提供了两种表示方式，它们都是基于表空间实现的。

* 1.**系统表空间**，这种表空间由数据目录里的一个或多个大文件构成。默认情况下InnoDB会将其表存储到这个系统表空间里，对于这种表与之唯一相关的文件是`.frm`文件
* 2.**独立表空间**，通过配置，InnoDB可以实现每个表一个表空间的存储模式。这种情况下对于这种表与之相关的文件是`.frm`文件和包含表数据和索引的`.ibd`文件。

系统表空间还有另一个用途,InnoDB在其内部维护这一个数据字典，其中包含了与每个表有关的信息。



如果是MyISAM存储引擎则会有3个文件。

* 1.`.frm`,格式文件包含了对该表结构的描述
* 2.`MYD`数据文件,存储了该表各行的内容
* 3.`MYI`索引文件，包含了该表所有的索引信息



### 2. 状态文件和日志文件

出了数据库目录之外，MySQL数据目录还包含许多状态文件和日志文件。

| 文件类型                 | 默认名             | 文件内容                                           |
| ------------------------ | ------------------ | -------------------------------------------------- |
| 进程ID文件               | hostname.pid       | MySQL服务器进程的ID                                |
| 常规查询日志             | hostname.log       | 连接/断开连接事件和查询信息                        |
| 慢查询日志               | hostname-slow.log  | 记录查询时间很长的命令信息                         |
| 变更日志                 | hostname.nnn       | 创建或修改数据表结构和内容的查询命令信息           |
| 二进制变更日志           | hostname-bin.nnn   | 创建或修改数据表结构和内容的查询命令的二进制表示法 |
| 二进制变更日志的索引文件 | hostname-bin.index | 使用中的“二进制变更日志”列表                       |
| 错误日志                 | hostname.err       | 记录“启动/关闭”事件和异常情况                      |


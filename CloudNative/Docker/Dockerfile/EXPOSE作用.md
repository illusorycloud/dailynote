# Dockerfile 中的 EXPOSE

## 1. 概述

EXPOSE 功能为暴漏容器运行时的监听端口给外部，但是EXPOSE并不会使容器访问主机的端口。

> 如果想使得容器与主机的端口有映射关系，必须在容器启动的时候加上 -P或者`-p 宿主机端口:容器端口`参数。

主要是帮助镜像使用者理解这个镜像服务的守护端口，以方便配置映射。



## 2. -p&-P 参数

```sh
docker run -p 8080:8080
docker run -P
```

在 Dockerfile 中指定 EXPOSE 之后还是需要通过`-p`或者`-P`参数来指定暴露端口。

* -P：大写P为自动映射，会将EXPOSE暴露出来的端口随机映射到宿主机的端口上，如果没有暴露端口，就不会有映射。
* -p：小写p为手动映射，需要自己指定宿主机的端口和容器的端口，形式为：`-p 宿主机端口:容器端口`




## 3. 小结

**EXPOSE 主要是帮助镜像使用者理解这个镜像服务的守护端口，以方便配置映射**。

无论有没有暴露端口、自动映射或者手动映射，宿主机都可以通过`容器IP+端口`进行访问。

* 有 EXPOSE 则可以通过`-P`进行随机映射；
* 没有则可以通过`-p`进行指定端口映射。